{% extends "layout.html" %}
{% block title %}Parkinson's — Multi Disease Predictor{% endblock %}

{% block content %}
<h2 class="page-title">Parkinson’s Disease Prediction</h2>

<!-- Predict button (top) -->
<button class="btn-primary" type="button"
        onclick="validateFormAndSubmit('parkinsonsForm','parkinsonsError')"
        style="margin-bottom:12px;">
    Predict
</button>

<!-- Error box -->
<div id="parkinsonsError" style="display:none; background:#ffeef0; border-left:4px solid #e11d48; padding:12px; margin-bottom:12px; border-radius:8px;">
  <strong style="color:#b91c1c">Error:</strong>
  <span style="margin-left:8px;color:#7f1d1d">Please fill all required fields before predicting.</span>
</div>

<!-- Result -->
{% if parkinsons_result %}
<div class="result-box {{ 'positive' if parkinsons_result=='Positive' else 'negative' }}" style="margin-bottom:18px;">
  <h3>{{ parkinsons_result }}</h3>
  <p>{{ parkinsons_message }}</p>
  <a class="btn-secondary" href="{{ url_for('parkinson_precaution') }}?res={{ parkinsons_result }}">More details →</a>
</div>
{% endif %}

<!-- FORM -->
<form id="parkinsonsForm" action="{{ url_for('predictparkinsons') }}" method="POST" class="form-card">
  <p class="small-muted">Enter numeric values. Placeholders show example ranges.</p>

  <div class="two-grid" style="gap:15px 25px;">
    <label>MDVP:Fo(Hz)
      <input name="f1" required type="number" step="any" placeholder="e.g. 80–260">
    </label>

    <label>MDVP:Fhi(Hz)
      <input name="f2" required type="number" step="any" placeholder="e.g. 100–600">
    </label>

    <label>MDVP:Flo(Hz)
      <input name="f3" required type="number" step="any" placeholder="e.g. 60–200">
    </label>

    <label>MDVP:Jitter(%)
      <input name="f4" required type="number" step="any" placeholder="e.g. 0.002–0.02">
    </label>

    <label>MDVP:Jitter(Abs)
      <input name="f5" required type="number" step="any" placeholder="e.g. 0.00001–0.0002">
    </label>

    <label>MDVP:RAP
      <input name="f6" required type="number" step="any" placeholder="e.g. 0.001–0.015">
    </label>

    <label>MDVP:PPQ
      <input name="f7" required type="number" step="any" placeholder="e.g. 0.001–0.015">
    </label>

    <label>Jitter:DDP
      <input name="f8" required type="number" step="any" placeholder="e.g. 0.003–0.05">
    </label>

    <label>MDVP:Shimmer
      <input name="f9" required type="number" step="any" placeholder="e.g. 0.02–0.1">
    </label>

    <label>MDVP:Shimmer(dB)
      <input name="f10" required type="number" step="any" placeholder="e.g. 0.1–1.0">
    </label>

    <label>Shimmer:APQ3
      <input name="f11" required type="number" step="any" placeholder="e.g. 0.01–0.04">
    </label>

    <label>Shimmer:APQ5
      <input name="f12" required type="number" step="any" placeholder="e.g. 0.02–0.06">
    </label>

    <label>MDVP:APQ
      <input name="f13" required type="number" step="any" placeholder="e.g. 0.02–0.08">
    </label>

    <label>Shimmer:DDA
      <input name="f14" required type="number" step="any" placeholder="e.g. 0.03–0.12">
    </label>

    <label>NHR
      <input name="f15" required type="number" step="any" placeholder="e.g. 0.0–0.3">
    </label>

    <label>HNR
      <input name="f16" required type="number" step="any" placeholder="e.g. 5–40">
    </label>

    <label>RPDE
      <input name="f17" required type="number" step="any" placeholder="e.g. 0.3–0.7">
    </label>

    <label>DFA
      <input name="f18" required type="number" step="any" placeholder="e.g. 0.6–1.0">
    </label>

    <label>Spread1
      <input name="f19" required type="number" step="any" placeholder="e.g. -8–-2">
    </label>

    <label>Spread2
      <input name="f20" required type="number" step="any" placeholder="e.g. 0.1–0.4">
    </label>

    <label>D2
      <input name="f21" required type="number" step="any" placeholder="e.g. 1.5–3.5">
    </label>

    <label>PPE
      <input name="f22" required type="number" step="any" placeholder="e.g. 0.1–0.6">
    </label>
  </div>

  <!-- hidden submit -->
  <button type="submit" style="display:none;"></button>
</form>

{% include 'chatbot.html' %}

<!-- Validation script -->
<script>
function validateFormAndSubmit(formId, errorId) {
  const form = document.getElementById(formId);
  const inputs = form.querySelectorAll('input[required]');
  let missing = false;
  for (let i=0; i<inputs.length; i++) {
    const v = inputs[i].value;
    if (!v || !v.toString().trim()) { missing = true; break; }
  }
  const err = document.getElementById(errorId);
  if (missing) {
    err.style.display = 'block';
    err.scrollIntoView({behavior:'smooth', block:'center'});
    return false;
  } else {
    err.style.display = 'none';
    form.submit();
  }
}
</script>
{% endblock %}
